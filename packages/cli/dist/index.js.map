{"version":3,"sources":["../src/index.ts","../src/config/constants.ts","../src/output/formatter.ts","../src/output/errors.ts","../src/config/profiles.ts","../src/config/storage.ts","../src/auth/local-key.ts","../src/auth/browser-auth.ts","../src/commands/init.ts","../src/commands/auth.ts","../src/commands/kv.ts","../src/lib/sdk.ts","../src/commands/space.ts","../src/lib/duration.ts","../src/commands/delegation.ts","../src/commands/share.ts","../src/commands/node.ts","../src/commands/profile.ts","../src/commands/completion.ts"],"sourcesContent":["import { Command } from \"commander\";\nimport { handleError } from \"./output/errors.js\";\nimport { registerInitCommand } from \"./commands/init.js\";\nimport { registerAuthCommand } from \"./commands/auth.js\";\nimport { registerKvCommand } from \"./commands/kv.js\";\nimport { registerSpaceCommand } from \"./commands/space.js\";\nimport { registerDelegationCommand } from \"./commands/delegation.js\";\nimport { registerShareCommand } from \"./commands/share.js\";\nimport { registerNodeCommand } from \"./commands/node.js\";\nimport { registerProfileCommand } from \"./commands/profile.js\";\nimport { registerCompletionCommand } from \"./commands/completion.js\";\n\nconst program = new Command();\n\nprogram\n  .name(\"tc\")\n  .description(\"TinyCloud CLI\")\n  .version(\"0.1.0\")\n  .option(\"-p, --profile <name>\", \"Profile to use\")\n  .option(\"-H, --host <url>\", \"TinyCloud node URL\")\n  .option(\"-v, --verbose\", \"Enable verbose output\")\n  .option(\"--no-cache\", \"Disable caching\")\n  .option(\"-q, --quiet\", \"Suppress non-essential output\");\n\nregisterInitCommand(program);\nregisterAuthCommand(program);\nregisterKvCommand(program);\nregisterSpaceCommand(program);\nregisterDelegationCommand(program);\nregisterShareCommand(program);\nregisterNodeCommand(program);\nregisterProfileCommand(program);\nregisterCompletionCommand(program);\n\ntry {\n  await program.parseAsync(process.argv);\n} catch (error) {\n  handleError(error);\n}\n","import { homedir } from \"node:os\";\nimport { join } from \"node:path\";\n\nexport const CONFIG_DIR = join(homedir(), \".tinycloud\");\nexport const PROFILES_DIR = join(CONFIG_DIR, \"profiles\");\nexport const CONFIG_FILE = join(CONFIG_DIR, \"config.json\");\n\nexport const DEFAULT_HOST = \"https://node.tinycloud.xyz\";\nexport const DEFAULT_PROFILE = \"default\";\nexport const DEFAULT_CHAIN_ID = 1;\n\nexport const ExitCode = {\n  SUCCESS: 0,\n  ERROR: 1,\n  USAGE_ERROR: 2,\n  AUTH_REQUIRED: 3,\n  NOT_FOUND: 4,\n  PERMISSION_DENIED: 5,\n  NETWORK_ERROR: 6,\n  NODE_ERROR: 7,\n} as const;\n","import ora from \"ora\";\n\nexport function outputJson(data: unknown): void {\n  process.stdout.write(JSON.stringify(data, null, 2) + \"\\n\");\n}\n\nexport function outputError(code: string, message: string): void {\n  process.stderr.write(\n    JSON.stringify({ error: { code, message } }, null, 2) + \"\\n\"\n  );\n}\n\nexport function isInteractive(): boolean {\n  return Boolean(process.stdout.isTTY);\n}\n\nexport async function withSpinner<T>(label: string, fn: () => Promise<T>): Promise<T> {\n  if (!isInteractive()) {\n    return fn();\n  }\n  const spinner = ora(label).start();\n  try {\n    const result = await fn();\n    spinner.succeed();\n    return result;\n  } catch (error) {\n    spinner.fail();\n    throw error;\n  }\n}\n","import { ExitCode } from \"../config/constants.js\";\nimport { outputError } from \"./formatter.js\";\n\nexport class CLIError extends Error {\n  constructor(\n    public code: string,\n    message: string,\n    public exitCode: number = ExitCode.ERROR\n  ) {\n    super(message);\n    this.name = \"CLIError\";\n  }\n}\n\nexport function wrapError(error: unknown): CLIError {\n  if (error instanceof CLIError) return error;\n\n  const message = error instanceof Error ? error.message : String(error);\n\n  // Map known error patterns to exit codes\n  if (message.includes(\"Not signed in\") || message.includes(\"AUTH_EXPIRED\") || message.includes(\"Session expired\")) {\n    return new CLIError(\"AUTH_REQUIRED\", message, ExitCode.AUTH_REQUIRED);\n  }\n  if (message.includes(\"NOT_FOUND\") || message.includes(\"KV_NOT_FOUND\")) {\n    return new CLIError(\"NOT_FOUND\", message, ExitCode.NOT_FOUND);\n  }\n  if (message.includes(\"PERMISSION_DENIED\")) {\n    return new CLIError(\"PERMISSION_DENIED\", message, ExitCode.PERMISSION_DENIED);\n  }\n  if (message.includes(\"ECONNREFUSED\") || message.includes(\"ETIMEDOUT\") || message.includes(\"fetch failed\")) {\n    return new CLIError(\"NETWORK_ERROR\", message, ExitCode.NETWORK_ERROR);\n  }\n\n  return new CLIError(\"ERROR\", message, ExitCode.ERROR);\n}\n\nexport function handleError(error: unknown): never {\n  const cliError = wrapError(error);\n  outputError(cliError.code, cliError.message);\n  process.exit(cliError.exitCode);\n}\n","import { join } from \"node:path\";\nimport {\n  CONFIG_DIR,\n  PROFILES_DIR,\n  CONFIG_FILE,\n  DEFAULT_PROFILE,\n  DEFAULT_HOST,\n} from \"./constants.js\";\nimport { rm } from \"node:fs/promises\";\nimport {\n  readJson,\n  writeJson,\n  fileExists,\n  ensureDir,\n  removeDir,\n  listDirs,\n} from \"./storage.js\";\nimport type { GlobalConfig, ProfileConfig, CLIContext } from \"./types.js\";\nimport { CLIError } from \"../output/errors.js\";\n\nexport class ProfileManager {\n  // ── Initialization ──────────────────────────────────────────────────\n\n  /**\n   * Creates ~/.tinycloud/ and ~/.tinycloud/profiles/ if they don't exist.\n   */\n  static async ensureConfigDir(): Promise<void> {\n    await ensureDir(CONFIG_DIR);\n    await ensureDir(PROFILES_DIR);\n  }\n\n  // ── Global config ───────────────────────────────────────────────────\n\n  /**\n   * Reads config.json. Returns a default config if the file is missing.\n   */\n  static async getConfig(): Promise<GlobalConfig> {\n    const config = await readJson<GlobalConfig>(CONFIG_FILE);\n    if (!config) {\n      return { defaultProfile: DEFAULT_PROFILE, version: 1 };\n    }\n    return config;\n  }\n\n  /**\n   * Writes the global config to config.json.\n   */\n  static async setConfig(config: GlobalConfig): Promise<void> {\n    await ProfileManager.ensureConfigDir();\n    await writeJson(CONFIG_FILE, config);\n  }\n\n  // ── Profile CRUD ────────────────────────────────────────────────────\n\n  /**\n   * Returns the profile config for the given name.\n   * Throws CLIError if the profile doesn't exist.\n   */\n  static async getProfile(name: string): Promise<ProfileConfig> {\n    const profilePath = join(PROFILES_DIR, name, \"profile.json\");\n    const profile = await readJson<ProfileConfig>(profilePath);\n    if (!profile) {\n      throw new CLIError(\n        \"PROFILE_NOT_FOUND\",\n        `Profile \"${name}\" does not exist. Run \\`tc init\\` or \\`tc profile create ${name}\\` first.`,\n      );\n    }\n    return profile;\n  }\n\n  /**\n   * Saves a profile config, creating the profile directory if needed.\n   */\n  static async setProfile(name: string, data: ProfileConfig): Promise<void> {\n    const profileDir = join(PROFILES_DIR, name);\n    await ensureDir(profileDir);\n    await writeJson(join(profileDir, \"profile.json\"), data);\n  }\n\n  /**\n   * Returns true if a profile directory exists.\n   */\n  static async profileExists(name: string): Promise<boolean> {\n    return fileExists(join(PROFILES_DIR, name, \"profile.json\"));\n  }\n\n  /**\n   * Returns an array of profile directory names.\n   */\n  static async listProfiles(): Promise<string[]> {\n    return listDirs(PROFILES_DIR);\n  }\n\n  /**\n   * Deletes a profile directory.\n   * Throws if trying to delete the current default profile.\n   */\n  static async deleteProfile(name: string): Promise<void> {\n    const config = await ProfileManager.getConfig();\n    if (config.defaultProfile === name) {\n      throw new CLIError(\n        \"PROFILE_DELETE_DEFAULT\",\n        `Cannot delete the default profile \"${name}\". Change the default first with \\`tc profile default <other>\\`.`,\n      );\n    }\n    const profileDir = join(PROFILES_DIR, name);\n    await removeDir(profileDir);\n  }\n\n  // ── Key management ──────────────────────────────────────────────────\n\n  /**\n   * Returns the parsed JWK for a profile, or null if no key exists.\n   */\n  static async getKey(name: string): Promise<object | null> {\n    return readJson<object>(join(PROFILES_DIR, name, \"key.json\"));\n  }\n\n  /**\n   * Saves a JWK key for a profile.\n   */\n  static async setKey(name: string, jwk: object): Promise<void> {\n    const profileDir = join(PROFILES_DIR, name);\n    await ensureDir(profileDir);\n    await writeJson(join(profileDir, \"key.json\"), jwk);\n  }\n\n  // ── Session management ──────────────────────────────────────────────\n\n  /**\n   * Returns the parsed session for a profile, or null if none exists.\n   */\n  static async getSession(name: string): Promise<object | null> {\n    return readJson<object>(join(PROFILES_DIR, name, \"session.json\"));\n  }\n\n  /**\n   * Saves session data for a profile.\n   */\n  static async setSession(name: string, session: object): Promise<void> {\n    const profileDir = join(PROFILES_DIR, name);\n    await ensureDir(profileDir);\n    await writeJson(join(profileDir, \"session.json\"), session);\n  }\n\n  /**\n   * Removes the session file for a profile.\n   */\n  static async clearSession(name: string): Promise<void> {\n    const sessionPath = join(PROFILES_DIR, name, \"session.json\");\n    try {\n      await rm(sessionPath);\n    } catch (err: unknown) {\n      if ((err as NodeJS.ErrnoException).code !== \"ENOENT\") {\n        throw err;\n      }\n    }\n  }\n\n  // ── Cache management ────────────────────────────────────────────────\n\n  /**\n   * Returns the path to the profile's cache directory, creating it if needed.\n   */\n  static async getCacheDir(name: string): Promise<string> {\n    const cacheDir = join(PROFILES_DIR, name, \"cache\");\n    await ensureDir(cacheDir);\n    return cacheDir;\n  }\n\n  // ── Resolution helpers ──────────────────────────────────────────────\n\n  /**\n   * Resolves the full CLI context from flags, env vars, and config.\n   *\n   * Profile resolution: options.profile > TC_PROFILE env > config.defaultProfile > \"default\"\n   * Host resolution:    options.host    > TC_HOST env    > profile.host          > DEFAULT_HOST\n   */\n  static async resolveContext(options: {\n    profile?: string;\n    host?: string;\n    verbose?: boolean;\n    noCache?: boolean;\n    quiet?: boolean;\n  }): Promise<CLIContext> {\n    // Resolve profile name\n    const config = await ProfileManager.getConfig();\n    const profile =\n      options.profile ??\n      process.env.TC_PROFILE ??\n      config.defaultProfile ??\n      DEFAULT_PROFILE;\n\n    // Resolve host — try profile config if it exists, but don't fail if it doesn't\n    let profileHost: string | undefined;\n    try {\n      const profileConfig = await ProfileManager.getProfile(profile);\n      profileHost = profileConfig.host;\n    } catch {\n      // Profile may not exist yet (e.g., during `tc init`)\n    }\n\n    const host =\n      options.host ??\n      process.env.TC_HOST ??\n      profileHost ??\n      DEFAULT_HOST;\n\n    return {\n      profile,\n      host,\n      verbose: options.verbose ?? false,\n      noCache: options.noCache ?? false,\n      quiet: options.quiet ?? false,\n    };\n  }\n}\n","import { readFile, writeFile, stat, mkdir, rm, readdir } from \"node:fs/promises\";\nimport { dirname } from \"node:path\";\n\n/**\n * Read and parse a JSON file. Returns null if the file does not exist.\n * Throws on any other error (permission denied, invalid JSON, etc.).\n */\nexport async function readJson<T>(filePath: string): Promise<T | null> {\n  try {\n    const data = await readFile(filePath, \"utf-8\");\n    return JSON.parse(data) as T;\n  } catch (err: unknown) {\n    if ((err as NodeJS.ErrnoException).code === \"ENOENT\") {\n      return null;\n    }\n    throw err;\n  }\n}\n\n/**\n * Write data as JSON to a file. Creates parent directories if needed.\n */\nexport async function writeJson(filePath: string, data: unknown): Promise<void> {\n  await mkdir(dirname(filePath), { recursive: true });\n  await writeFile(filePath, JSON.stringify(data, null, 2) + \"\\n\", \"utf-8\");\n}\n\n/**\n * Check if a file exists at the given path.\n */\nexport async function fileExists(filePath: string): Promise<boolean> {\n  try {\n    await stat(filePath);\n    return true;\n  } catch (err: unknown) {\n    if ((err as NodeJS.ErrnoException).code === \"ENOENT\") {\n      return false;\n    }\n    throw err;\n  }\n}\n\n/**\n * Ensure a directory exists (mkdir -p).\n */\nexport async function ensureDir(dirPath: string): Promise<void> {\n  await mkdir(dirPath, { recursive: true });\n}\n\n/**\n * Remove a directory recursively (rm -rf).\n */\nexport async function removeDir(dirPath: string): Promise<void> {\n  await rm(dirPath, { recursive: true, force: true });\n}\n\n/**\n * List directory names (not files) inside a directory.\n * Returns an empty array if the directory does not exist.\n */\nexport async function listDirs(dirPath: string): Promise<string[]> {\n  try {\n    const entries = await readdir(dirPath, { withFileTypes: true });\n    return entries.filter((e) => e.isDirectory()).map((e) => e.name);\n  } catch (err: unknown) {\n    if ((err as NodeJS.ErrnoException).code === \"ENOENT\") {\n      return [];\n    }\n    throw err;\n  }\n}\n","import { TCWSessionManager, initPanicHook } from \"@tinycloud/node-sdk-wasm\";\n\nlet wasmInitialized = false;\n\nfunction ensureWasm(): void {\n  if (!wasmInitialized) {\n    initPanicHook();\n    wasmInitialized = true;\n  }\n}\n\n/**\n * Generate a new Ed25519 keypair. Returns the JWK.\n */\nexport function generateKey(): { jwk: object; did: string } {\n  ensureWasm();\n  const mgr = new TCWSessionManager();\n  const keyId = mgr.createSessionKey(\"cli\");\n  const jwkStr = mgr.jwk(keyId);\n  if (!jwkStr) throw new Error(\"Failed to generate key\");\n  const jwk = JSON.parse(jwkStr);\n  const did = mgr.getDID(keyId);\n  return { jwk, did };\n}\n\n/**\n * Get the DID from an existing JWK.\n */\nexport function keyToDID(jwk: object): string {\n  ensureWasm();\n  const mgr = new TCWSessionManager();\n  // Import key by creating with known ID, then getting DID\n  // For now, re-generate and return — TODO: import support\n  const keyId = mgr.createSessionKey(\"imported\");\n  return mgr.getDID(keyId);\n}\n","import { createServer, type IncomingMessage, type ServerResponse } from \"node:http\";\nimport { isInteractive } from \"../output/formatter.js\";\nimport { createInterface } from \"node:readline\";\n\nconst OPENKEY_BASE = \"https://openkey.cloud\";\n\ninterface DelegationData {\n  delegationHeader: { Authorization: string };\n  delegationCid: string;\n  spaceId: string;\n  [key: string]: unknown;\n}\n\n/**\n * Start the browser auth flow.\n * Mode 1 (default): local HTTP callback server\n * Mode 2 (--paste): manual code paste\n */\nexport async function startAuthFlow(\n  did: string,\n  options: { paste?: boolean } = {}\n): Promise<DelegationData> {\n  if (options.paste) {\n    return pasteFlow(did);\n  }\n\n  try {\n    return await callbackFlow(did);\n  } catch {\n    // Fallback to paste if browser can't open\n    if (isInteractive()) {\n      console.error(\"Could not open browser. Falling back to manual paste mode.\");\n      return pasteFlow(did);\n    }\n    throw new Error(\"Cannot open browser in non-interactive mode. Use --paste flag.\");\n  }\n}\n\nasync function callbackFlow(did: string): Promise<DelegationData> {\n  return new Promise((resolve, reject) => {\n    const server = createServer((req: IncomingMessage, res: ServerResponse) => {\n      if (req.method === \"POST\" && req.url === \"/callback\") {\n        let body = \"\";\n        req.on(\"data\", (chunk: Buffer) => { body += chunk.toString(); });\n        req.on(\"end\", () => {\n          try {\n            const data = JSON.parse(body) as DelegationData;\n            // Send CORS headers and success response\n            res.writeHead(200, {\n              \"Content-Type\": \"application/json\",\n              \"Access-Control-Allow-Origin\": \"*\",\n            });\n            res.end(JSON.stringify({ success: true }));\n            server.close();\n            resolve(data);\n          } catch (err) {\n            res.writeHead(400, { \"Content-Type\": \"application/json\" });\n            res.end(JSON.stringify({ error: \"Invalid JSON\" }));\n            reject(new Error(\"Invalid delegation data received\"));\n          }\n        });\n      } else if (req.method === \"OPTIONS\") {\n        // CORS preflight\n        res.writeHead(204, {\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\n          \"Access-Control-Allow-Headers\": \"Content-Type\",\n        });\n        res.end();\n      } else {\n        res.writeHead(404);\n        res.end();\n      }\n    });\n\n    server.listen(0, \"127.0.0.1\", async () => {\n      const addr = server.address();\n      if (!addr || typeof addr === \"string\") {\n        reject(new Error(\"Failed to start callback server\"));\n        return;\n      }\n      const port = addr.port;\n      const callbackUrl = `http://127.0.0.1:${port}/callback`;\n      const authUrl = `${OPENKEY_BASE}/delegate?did=${encodeURIComponent(did)}&callback=${encodeURIComponent(callbackUrl)}`;\n\n      if (isInteractive()) {\n        console.error(`Opening browser for authentication...`);\n        console.error(`If the browser doesn't open, visit: ${authUrl}`);\n      }\n\n      try {\n        const open = (await import(\"open\")).default;\n        await open(authUrl);\n      } catch {\n        server.close();\n        throw new Error(\"Failed to open browser\");\n      }\n    });\n\n    // Timeout after 5 minutes\n    setTimeout(() => {\n      server.close();\n      reject(new Error(\"Authentication timed out after 5 minutes\"));\n    }, 5 * 60 * 1000);\n  });\n}\n\nasync function pasteFlow(did: string): Promise<DelegationData> {\n  const authUrl = `${OPENKEY_BASE}/delegate?did=${encodeURIComponent(did)}`;\n\n  console.error(`\\nOpen this URL in a browser to authenticate:\\n`);\n  console.error(`  ${authUrl}\\n`);\n\n  const rl = createInterface({\n    input: process.stdin,\n    output: process.stderr,\n  });\n\n  return new Promise((resolve, reject) => {\n    rl.question(\"Paste delegation code: \", (input) => {\n      rl.close();\n      try {\n        // Try parsing as JSON directly\n        const data = JSON.parse(input.trim()) as DelegationData;\n        resolve(data);\n      } catch {\n        // Try base64 decoding first\n        try {\n          const decoded = Buffer.from(input.trim(), \"base64\").toString(\"utf-8\");\n          const data = JSON.parse(decoded) as DelegationData;\n          resolve(data);\n        } catch {\n          reject(new Error(\"Invalid delegation code. Expected JSON or base64-encoded JSON.\"));\n        }\n      }\n    });\n  });\n}\n","import { Command } from \"commander\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson, withSpinner } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode, DEFAULT_HOST, DEFAULT_CHAIN_ID } from \"../config/constants.js\";\nimport { generateKey } from \"../auth/local-key.js\";\nimport { startAuthFlow } from \"../auth/browser-auth.js\";\n\nexport function registerInitCommand(program: Command): void {\n  program\n    .command(\"init\")\n    .description(\"Initialize a new TinyCloud profile\")\n    .option(\"--name <profile>\", \"Profile name\", \"default\")\n    .option(\"--key-only\", \"Only generate key, skip authentication\")\n    .option(\"--host <url>\", \"TinyCloud node URL\")\n    .option(\"--paste\", \"Use manual paste mode for authentication\")\n    .action(async (options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const profileName: string = options.name;\n        const host: string = options.host ?? globalOpts.host ?? DEFAULT_HOST;\n\n        // Check if profile already exists\n        if (await ProfileManager.profileExists(profileName)) {\n          throw new CLIError(\n            \"PROFILE_EXISTS\",\n            `Profile \"${profileName}\" already exists. Use \\`tc profile delete ${profileName}\\` first or choose a different name.`,\n            ExitCode.ERROR,\n          );\n        }\n\n        await ProfileManager.ensureConfigDir();\n\n        // Generate key\n        const { jwk, did } = await withSpinner(\"Generating key...\", async () => {\n          return generateKey();\n        });\n\n        await ProfileManager.setKey(profileName, jwk);\n\n        // Create initial profile\n        const profileConfig = {\n          name: profileName,\n          host,\n          chainId: DEFAULT_CHAIN_ID,\n          spaceName: \"default\",\n          did,\n          createdAt: new Date().toISOString(),\n        };\n\n        await ProfileManager.setProfile(profileName, profileConfig);\n\n        // Set as default if this is \"default\" or no default exists\n        const config = await ProfileManager.getConfig();\n        if (profileName === \"default\" || !await ProfileManager.profileExists(config.defaultProfile)) {\n          await ProfileManager.setConfig({ ...config, defaultProfile: profileName });\n        }\n\n        if (options.keyOnly) {\n          outputJson({\n            profile: profileName,\n            did,\n            host,\n            authenticated: false,\n          });\n          return;\n        }\n\n        // Auth flow\n        const delegationData = await startAuthFlow(did, { paste: options.paste });\n\n        // Store session\n        await ProfileManager.setSession(profileName, delegationData);\n\n        // Update profile with auth data\n        await ProfileManager.setProfile(profileName, {\n          ...profileConfig,\n          spaceId: delegationData.spaceId,\n          primaryDid: delegationData.primaryDid as string | undefined,\n        });\n\n        outputJson({\n          profile: profileName,\n          did,\n          host,\n          spaceId: delegationData.spaceId,\n          authenticated: true,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { Command } from \"commander\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\nimport { startAuthFlow } from \"../auth/browser-auth.js\";\n\nexport function registerAuthCommand(program: Command): void {\n  const auth = program.command(\"auth\").description(\"Authentication management\");\n\n  auth\n    .command(\"login\")\n    .description(\"Authenticate with OpenKey\")\n    .option(\"--paste\", \"Use manual paste mode instead of browser callback\")\n    .action(async (options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const key = await ProfileManager.getKey(ctx.profile);\n        if (!key) {\n          throw new CLIError(\n            \"NO_KEY\",\n            `No key found for profile \"${ctx.profile}\". Run \\`tc init\\` first.`,\n            ExitCode.AUTH_REQUIRED,\n          );\n        }\n\n        // Get DID from profile\n        const profile = await ProfileManager.getProfile(ctx.profile);\n\n        // Start browser auth flow\n        const delegationData = await startAuthFlow(profile.did, {\n          paste: options.paste,\n        });\n\n        // Store session\n        await ProfileManager.setSession(ctx.profile, delegationData);\n\n        // Update profile with primary DID if present\n        if (delegationData.spaceId) {\n          await ProfileManager.setProfile(ctx.profile, {\n            ...profile,\n            spaceId: delegationData.spaceId,\n            primaryDid: delegationData.primaryDid as string | undefined,\n          });\n        }\n\n        outputJson({\n          authenticated: true,\n          profile: ctx.profile,\n          did: profile.did,\n          spaceId: delegationData.spaceId,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  auth\n    .command(\"logout\")\n    .description(\"Clear session (keep key)\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        await ProfileManager.clearSession(ctx.profile);\n        outputJson({ profile: ctx.profile, authenticated: false });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  auth\n    .command(\"status\")\n    .description(\"Show current authentication state\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const hasKey = await ProfileManager.getKey(ctx.profile);\n        const session = await ProfileManager.getSession(ctx.profile);\n        let profile;\n        try {\n          profile = await ProfileManager.getProfile(ctx.profile);\n        } catch {\n          profile = null;\n        }\n\n        outputJson({\n          authenticated: session !== null,\n          did: profile?.did ?? null,\n          primaryDid: profile?.primaryDid ?? null,\n          spaceId: profile?.spaceId ?? null,\n          host: ctx.host,\n          profile: ctx.profile,\n          hasKey: hasKey !== null,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  auth\n    .command(\"whoami\")\n    .description(\"Show identity information\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const profile = await ProfileManager.getProfile(ctx.profile);\n        const session = await ProfileManager.getSession(ctx.profile);\n\n        outputJson({\n          profile: ctx.profile,\n          did: profile.did,\n          primaryDid: profile.primaryDid ?? null,\n          spaceId: profile.spaceId ?? null,\n          host: profile.host,\n          authenticated: session !== null,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { Command } from \"commander\";\nimport { readFile } from \"node:fs/promises\";\nimport { writeFile } from \"node:fs/promises\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson, withSpinner } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\nimport { ensureAuthenticated } from \"../lib/sdk.js\";\n\n/**\n * Read all data from stdin.\n */\nasync function readStdin(): Promise<Buffer> {\n  const chunks: Buffer[] = [];\n  for await (const chunk of process.stdin) {\n    chunks.push(typeof chunk === \"string\" ? Buffer.from(chunk) : chunk);\n  }\n  return Buffer.concat(chunks);\n}\n\nexport function registerKvCommand(program: Command): void {\n  const kv = program.command(\"kv\").description(\"Key-value store operations\");\n\n  // tc kv get <key>\n  kv\n    .command(\"get <key>\")\n    .description(\"Get a value by key\")\n    .option(\"--raw\", \"Output raw value (no JSON wrapping)\")\n    .option(\"-o, --output <file>\", \"Write value to file\")\n    .action(async (key: string, options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await withSpinner(`Getting ${key}...`, () => node.kv.get(key)) as any;\n\n        if (!result.ok) {\n          if (result.error.code === \"KV_NOT_FOUND\" || result.error.code === \"NOT_FOUND\") {\n            throw new CLIError(\"NOT_FOUND\", `Key \"${key}\" not found`, ExitCode.NOT_FOUND);\n          }\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        const data = result.data.data;\n        const metadata = result.data.headers ?? {};\n\n        if (options.output) {\n          // Write to file\n          const content = typeof data === \"string\" ? data : JSON.stringify(data);\n          await writeFile(options.output, content);\n          outputJson({ key, written: options.output });\n          return;\n        }\n\n        if (options.raw) {\n          // Raw output - write directly to stdout\n          const content = typeof data === \"string\" ? data : JSON.stringify(data);\n          process.stdout.write(content);\n          return;\n        }\n\n        // Default JSON output\n        outputJson({\n          key,\n          data,\n          metadata,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  // tc kv put <key> [value]\n  kv\n    .command(\"put <key> [value]\")\n    .description(\"Set a value\")\n    .option(\"--file <path>\", \"Read value from file\")\n    .option(\"--stdin\", \"Read value from stdin\")\n    .action(async (key: string, value: string | undefined, options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        // Determine value source\n        let putValue: string | Buffer;\n        const sources = [value !== undefined, !!options.file, !!options.stdin].filter(Boolean);\n\n        if (sources.length === 0) {\n          throw new CLIError(\"USAGE_ERROR\", \"Must provide a value, --file, or --stdin\", ExitCode.USAGE_ERROR);\n        }\n        if (sources.length > 1) {\n          throw new CLIError(\"USAGE_ERROR\", \"Provide only one of: value argument, --file, or --stdin\", ExitCode.USAGE_ERROR);\n        }\n\n        if (options.file) {\n          putValue = await readFile(options.file);\n        } else if (options.stdin) {\n          putValue = await readStdin();\n        } else {\n          // Try to parse as JSON, fall back to string\n          try {\n            putValue = JSON.parse(value!);\n          } catch {\n            putValue = value!;\n          }\n        }\n\n        const result = await withSpinner(`Writing ${key}...`, () => node.kv.put(key, putValue)) as any;\n\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({ key, written: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  // tc kv delete <key>\n  kv\n    .command(\"delete <key>\")\n    .description(\"Delete a key\")\n    .action(async (key: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await withSpinner(`Deleting ${key}...`, () => node.kv.delete(key)) as any;\n\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({ key, deleted: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  // tc kv list\n  kv\n    .command(\"list\")\n    .description(\"List keys\")\n    .option(\"--prefix <prefix>\", \"Filter by key prefix\")\n    .action(async (options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const listOptions = options.prefix ? { prefix: options.prefix } : undefined;\n        const result = await withSpinner(\"Listing keys...\", () => node.kv.list(listOptions)) as any;\n\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        const keys = result.data.data ?? result.data;\n        const keyList = Array.isArray(keys) ? keys : [];\n\n        outputJson({\n          keys: keyList,\n          count: keyList.length,\n          prefix: options.prefix ?? null,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  // tc kv head <key>\n  kv\n    .command(\"head <key>\")\n    .description(\"Get metadata for a key (no body)\")\n    .action(async (key: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await withSpinner(`Checking ${key}...`, () => node.kv.head(key)) as any;\n\n        if (!result.ok) {\n          if (result.error.code === \"KV_NOT_FOUND\" || result.error.code === \"NOT_FOUND\") {\n            outputJson({ key, exists: false, metadata: {} });\n            return;\n          }\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({\n          key,\n          exists: true,\n          metadata: result.data.headers ?? {},\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { TinyCloudNode } from \"@tinycloud/node-sdk\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport type { CLIContext } from \"../config/types.js\";\nimport { CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\n\n/**\n * Create a TinyCloudNode instance from the current CLI context.\n * Uses the profile's persisted session and key.\n */\nexport async function createSDKInstance(ctx: CLIContext): Promise<TinyCloudNode> {\n  const profile = await ProfileManager.getProfile(ctx.profile);\n  const session = await ProfileManager.getSession(ctx.profile);\n  const key = await ProfileManager.getKey(ctx.profile);\n\n  if (!key) {\n    throw new CLIError(\n      \"AUTH_REQUIRED\",\n      `No key found for profile \"${ctx.profile}\". Run \\`tc init\\` first.`,\n      ExitCode.AUTH_REQUIRED,\n    );\n  }\n\n  const node = new TinyCloudNode({\n    host: ctx.host,\n  });\n\n  return node;\n}\n\n/**\n * Ensure the user is authenticated.\n * Throws AUTH_REQUIRED if no session exists.\n */\nexport async function ensureAuthenticated(ctx: CLIContext): Promise<TinyCloudNode> {\n  const session = await ProfileManager.getSession(ctx.profile);\n\n  if (!session) {\n    throw new CLIError(\n      \"AUTH_REQUIRED\",\n      `Not authenticated. Run \\`tc auth login\\` or \\`tc init\\` first.`,\n      ExitCode.AUTH_REQUIRED,\n    );\n  }\n\n  // TODO: Check session expiry and prompt for re-auth if interactive\n\n  return createSDKInstance(ctx);\n}\n","import { Command } from \"commander\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\nimport { ensureAuthenticated } from \"../lib/sdk.js\";\n\nexport function registerSpaceCommand(program: Command): void {\n  const space = program.command(\"space\").description(\"Space management\");\n\n  space\n    .command(\"list\")\n    .description(\"List spaces\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.spaces.list();\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n        outputJson({ spaces: result.data, count: result.data.length });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  space\n    .command(\"create <name>\")\n    .description(\"Create a new space\")\n    .action(async (name: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.spaces.create(name);\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n        outputJson({ spaceId: result.data.id, name });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  space\n    .command(\"info [space-id]\")\n    .description(\"Get space info\")\n    .action(async (spaceId: string | undefined, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const targetId = spaceId ?? node.spaceId;\n        if (!targetId) {\n          throw new CLIError(\"NO_SPACE\", \"No space ID specified and no active space\", ExitCode.ERROR);\n        }\n\n        const profile = await ProfileManager.getProfile(ctx.profile);\n        outputJson({\n          spaceId: targetId,\n          name: profile.spaceName,\n          owner: node.did,\n          host: ctx.host,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  space\n    .command(\"switch <name>\")\n    .description(\"Switch active space\")\n    .action(async (name: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const profile = await ProfileManager.getProfile(ctx.profile);\n        await ProfileManager.setProfile(ctx.profile, { ...profile, spaceName: name });\n\n        outputJson({ profile: ctx.profile, spaceName: name, switched: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","/**\n * Parse a duration string into milliseconds.\n * Supports: \"1h\", \"30m\", \"7d\", \"1w\", or ISO date string.\n */\nexport function parseDuration(input: string): number {\n  const match = input.match(/^(\\d+)(m|h|d|w)$/);\n  if (match) {\n    const value = parseInt(match[1], 10);\n    const unit = match[2];\n    const multipliers: Record<string, number> = {\n      m: 60 * 1000,\n      h: 60 * 60 * 1000,\n      d: 24 * 60 * 60 * 1000,\n      w: 7 * 24 * 60 * 60 * 1000,\n    };\n    return value * multipliers[unit];\n  }\n\n  // Try as ISO date\n  const date = new Date(input);\n  if (!isNaN(date.getTime())) {\n    const ms = date.getTime() - Date.now();\n    if (ms <= 0) {\n      throw new Error(`Expiry date \"${input}\" is in the past`);\n    }\n    return ms;\n  }\n\n  throw new Error(`Invalid duration: \"${input}\". Use format like \"1h\", \"7d\", or an ISO date.`);\n}\n\n/**\n * Parse duration to an expiry Date.\n */\nexport function parseExpiry(input: string): Date {\n  return new Date(Date.now() + parseDuration(input));\n}\n","import { Command } from \"commander\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\nimport { ensureAuthenticated } from \"../lib/sdk.js\";\nimport { parseExpiry } from \"../lib/duration.js\";\n\nexport function registerDelegationCommand(program: Command): void {\n  const delegation = program.command(\"delegation\").description(\"Manage delegations\");\n\n  delegation\n    .command(\"create\")\n    .description(\"Create a delegation\")\n    .requiredOption(\"--to <did>\", \"Recipient DID\")\n    .requiredOption(\"--path <path>\", \"KV path scope\")\n    .requiredOption(\"--actions <actions>\", \"Comma-separated actions (e.g., kv/get,kv/list)\")\n    .option(\"--expiry <duration>\", \"Expiry duration (e.g., 1h, 7d, ISO date)\", \"1h\")\n    .action(async (options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const actions = options.actions.split(\",\").map((a: string) => {\n          const trimmed = a.trim();\n          return trimmed.startsWith(\"tinycloud.\") ? trimmed : `tinycloud.${trimmed}`;\n        });\n\n        const expiry = parseExpiry(options.expiry);\n\n        const result = await node.delegationManager.create({\n          delegateDID: options.to,\n          path: options.path,\n          actions,\n          expiry,\n        });\n\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({\n          cid: result.data.cid,\n          delegateDid: options.to,\n          path: options.path,\n          actions,\n          expiry: expiry.toISOString(),\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  delegation\n    .command(\"list\")\n    .description(\"List delegations\")\n    .option(\"--granted\", \"Show only delegations I've granted\")\n    .option(\"--received\", \"Show only delegations I've received\")\n    .action(async (options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.delegationManager.list();\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        let delegations: any[] = result.data;\n\n        // Filter if requested\n        if (options.granted) {\n          const myDid = node.did;\n          delegations = delegations.filter((d: any) => d.delegatorDID === myDid);\n        } else if (options.received) {\n          const myDid = node.did;\n          delegations = delegations.filter((d: any) => d.delegateDID === myDid || d.delegateDID?.includes(myDid));\n        }\n\n        outputJson({\n          delegations: delegations.map((d: any) => ({\n            cid: d.cid,\n            delegatee: d.delegateDID,\n            delegator: d.delegatorDID,\n            path: d.path,\n            actions: d.actions,\n            expiry: d.expiry instanceof Date ? d.expiry.toISOString() : d.expiry,\n          })),\n          count: delegations.length,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  delegation\n    .command(\"info <cid>\")\n    .description(\"Get delegation details\")\n    .action(async (cid: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.delegationManager.get(cid);\n        if (!result.ok) {\n          throw new CLIError(\"NOT_FOUND\", `Delegation \"${cid}\" not found`, ExitCode.NOT_FOUND);\n        }\n\n        outputJson(result.data);\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  delegation\n    .command(\"revoke <cid>\")\n    .description(\"Revoke a delegation\")\n    .action(async (cid: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.delegationManager.revoke(cid);\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({ cid, revoked: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { Command } from \"commander\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\nimport { ensureAuthenticated } from \"../lib/sdk.js\";\nimport { parseExpiry } from \"../lib/duration.js\";\n\nexport function registerShareCommand(program: Command): void {\n  const share = program.command(\"share\").description(\"Share data with others\");\n\n  share\n    .command(\"create\")\n    .description(\"Create a share link\")\n    .requiredOption(\"--path <path>\", \"KV path scope\")\n    .option(\"--actions <actions>\", \"Comma-separated actions\", \"kv/get\")\n    .option(\"--expiry <duration>\", \"Expiry duration\", \"7d\")\n    .option(\"--web-link\", \"Generate a web UI link for non-technical recipients\")\n    .action(async (options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const actions = options.actions.split(\",\").map((a: string) => {\n          const trimmed = a.trim();\n          return trimmed.startsWith(\"tinycloud.\") ? trimmed : `tinycloud.${trimmed}`;\n        });\n\n        const expiry = parseExpiry(options.expiry);\n\n        const result = await node.sharing.generate({\n          path: options.path,\n          actions,\n          expiry,\n        });\n\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        const output: Record<string, unknown> = {\n          token: result.data.token ?? result.data.cid,\n          shareData: result.data.encodedData ?? result.data.url,\n          path: options.path,\n          actions,\n          expiry: expiry.toISOString(),\n        };\n\n        if (options.webLink) {\n          const shareData = result.data.encodedData ?? result.data.url ?? \"\";\n          output.webLink = `https://openkey.cloud/share?data=${encodeURIComponent(shareData)}`;\n        }\n\n        outputJson(output);\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  share\n    .command(\"receive [data]\")\n    .description(\"Receive a share\")\n    .option(\"--stdin\", \"Read share data from stdin\")\n    .action(async (data: string | undefined, options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        let shareData: string;\n        if (options.stdin) {\n          const chunks: Buffer[] = [];\n          for await (const chunk of process.stdin) {\n            chunks.push(typeof chunk === \"string\" ? Buffer.from(chunk) : chunk);\n          }\n          shareData = Buffer.concat(chunks).toString(\"utf-8\").trim();\n        } else if (data) {\n          shareData = data;\n        } else {\n          throw new CLIError(\"USAGE_ERROR\", \"Must provide share data or use --stdin\", ExitCode.USAGE_ERROR);\n        }\n\n        const result = await node.sharing.receive(shareData);\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({\n          received: true,\n          spaceId: result.data.spaceId,\n          path: result.data.path,\n          actions: result.data.actions,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  share\n    .command(\"list\")\n    .description(\"List active shares\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.sharing.list();\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({ shares: result.data, count: result.data.length });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  share\n    .command(\"revoke <token>\")\n    .description(\"Revoke a share\")\n    .action(async (token: string, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const node = await ensureAuthenticated(ctx);\n\n        const result = await node.sharing.revoke(token);\n        if (!result.ok) {\n          throw new CLIError(result.error.code, result.error.message, ExitCode.ERROR);\n        }\n\n        outputJson({ token, revoked: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { Command } from \"commander\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\n\nexport function registerNodeCommand(program: Command): void {\n  const node = program.command(\"node\").description(\"Node health and info\");\n\n  node\n    .command(\"health\")\n    .description(\"Check node health\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const start = Date.now();\n        const response = await fetch(`${ctx.host}/healthz`);\n        const latencyMs = Date.now() - start;\n\n        outputJson({\n          healthy: response.ok,\n          host: ctx.host,\n          latencyMs,\n        });\n      } catch (error) {\n        if (error instanceof TypeError && (error as Error).message.includes(\"fetch\")) {\n          outputJson({ healthy: false, host: (await ProfileManager.resolveContext(cmd.optsWithGlobals())).host, error: \"Connection refused\" });\n        } else {\n          handleError(error);\n        }\n      }\n    });\n\n  node\n    .command(\"version\")\n    .description(\"Get node version\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const response = await fetch(`${ctx.host}/version`);\n        if (!response.ok) {\n          throw new CLIError(\"NODE_ERROR\", `Node returned ${response.status}`, ExitCode.NODE_ERROR);\n        }\n\n        const data = await response.json() as Record<string, unknown>;\n        outputJson({ ...data, host: ctx.host });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  node\n    .command(\"status\")\n    .description(\"Combined health and version info\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n\n        const start = Date.now();\n\n        // Fetch health and version in parallel\n        const [healthRes, versionRes] = await Promise.allSettled([\n          fetch(`${ctx.host}/healthz`),\n          fetch(`${ctx.host}/version`),\n        ]);\n\n        const latencyMs = Date.now() - start;\n        const healthy = healthRes.status === \"fulfilled\" && healthRes.value.ok;\n\n        let versionData: Record<string, unknown> = {};\n        if (versionRes.status === \"fulfilled\" && versionRes.value.ok) {\n          versionData = await versionRes.value.json() as Record<string, unknown>;\n        }\n\n        outputJson({\n          healthy,\n          host: ctx.host,\n          latencyMs,\n          ...versionData,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { Command } from \"commander\";\nimport { createInterface } from \"node:readline\";\nimport { ProfileManager } from \"../config/profiles.js\";\nimport { outputJson, isInteractive } from \"../output/formatter.js\";\nimport { handleError, CLIError } from \"../output/errors.js\";\nimport { ExitCode } from \"../config/constants.js\";\nimport { generateKey } from \"../auth/local-key.js\";\n\nexport function registerProfileCommand(program: Command): void {\n  const profile = program.command(\"profile\").description(\"Profile management\");\n\n  profile\n    .command(\"list\")\n    .description(\"List all profiles\")\n    .action(async (_options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const config = await ProfileManager.getConfig();\n        const names = await ProfileManager.listProfiles();\n\n        const profiles = await Promise.all(\n          names.map(async (name) => {\n            try {\n              const p = await ProfileManager.getProfile(name);\n              return {\n                name: p.name,\n                host: p.host,\n                did: p.did,\n                active: name === config.defaultProfile,\n              };\n            } catch {\n              return { name, host: null, did: null, active: name === config.defaultProfile };\n            }\n          })\n        );\n\n        outputJson({\n          profiles,\n          defaultProfile: config.defaultProfile,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  profile\n    .command(\"create <name>\")\n    .description(\"Create a new profile\")\n    .option(\"--host <url>\", \"TinyCloud node URL\")\n    .action(async (name: string, options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const host = options.host ?? globalOpts.host ?? \"https://node.tinycloud.xyz\";\n\n        if (await ProfileManager.profileExists(name)) {\n          throw new CLIError(\"PROFILE_EXISTS\", `Profile \"${name}\" already exists`, ExitCode.ERROR);\n        }\n\n        await ProfileManager.ensureConfigDir();\n        const { jwk, did } = generateKey();\n        await ProfileManager.setKey(name, jwk);\n        await ProfileManager.setProfile(name, {\n          name,\n          host,\n          chainId: 1,\n          spaceName: \"default\",\n          did,\n          createdAt: new Date().toISOString(),\n        });\n\n        outputJson({ profile: name, did, host, created: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  profile\n    .command(\"show [name]\")\n    .description(\"Show profile details\")\n    .action(async (name: string | undefined, _options, cmd) => {\n      try {\n        const globalOpts = cmd.optsWithGlobals();\n        const ctx = await ProfileManager.resolveContext(globalOpts);\n        const profileName = name ?? ctx.profile;\n\n        const p = await ProfileManager.getProfile(profileName);\n        const hasKey = (await ProfileManager.getKey(profileName)) !== null;\n        const hasSession = (await ProfileManager.getSession(profileName)) !== null;\n        const config = await ProfileManager.getConfig();\n\n        outputJson({\n          ...p,\n          hasKey,\n          hasSession,\n          isDefault: profileName === config.defaultProfile,\n        });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  profile\n    .command(\"switch <name>\")\n    .description(\"Set default profile\")\n    .action(async (name: string, _options, cmd) => {\n      try {\n        if (!(await ProfileManager.profileExists(name))) {\n          throw new CLIError(\"PROFILE_NOT_FOUND\", `Profile \"${name}\" does not exist`, ExitCode.NOT_FOUND);\n        }\n\n        const config = await ProfileManager.getConfig();\n        await ProfileManager.setConfig({ ...config, defaultProfile: name });\n\n        outputJson({ defaultProfile: name, switched: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n\n  profile\n    .command(\"delete <name>\")\n    .description(\"Delete a profile\")\n    .action(async (name: string, _options, cmd) => {\n      try {\n        // Confirmation prompt if interactive\n        if (isInteractive()) {\n          const rl = createInterface({ input: process.stdin, output: process.stderr });\n          const answer = await new Promise<string>((resolve) => {\n            rl.question(`Delete profile \"${name}\"? This cannot be undone. [y/N] `, resolve);\n          });\n          rl.close();\n          if (answer.toLowerCase() !== \"y\") {\n            outputJson({ profile: name, deleted: false, reason: \"Cancelled by user\" });\n            return;\n          }\n        }\n\n        await ProfileManager.deleteProfile(name);\n        outputJson({ profile: name, deleted: true });\n      } catch (error) {\n        handleError(error);\n      }\n    });\n}\n","import { Command } from \"commander\";\n\nexport function registerCompletionCommand(program: Command): void {\n  const completion = program.command(\"completion\").description(\"Generate shell completions\");\n\n  completion\n    .command(\"bash\")\n    .description(\"Output bash completions\")\n    .action(() => {\n      const script = generateBashCompletion();\n      process.stdout.write(script);\n    });\n\n  completion\n    .command(\"zsh\")\n    .description(\"Output zsh completions\")\n    .action(() => {\n      const script = generateZshCompletion();\n      process.stdout.write(script);\n    });\n\n  completion\n    .command(\"fish\")\n    .description(\"Output fish completions\")\n    .action(() => {\n      const script = generateFishCompletion();\n      process.stdout.write(script);\n    });\n}\n\nfunction generateBashCompletion(): string {\n  return `# tc bash completion\n_tc_completions() {\n  local cur prev commands subcommands\n  COMPREPLY=()\n  cur=\"\\${COMP_WORDS[COMP_CWORD]}\"\n  prev=\"\\${COMP_WORDS[COMP_CWORD-1]}\"\n\n  commands=\"init auth kv space delegation share node profile completion\"\n\n  case \"\\${COMP_WORDS[1]}\" in\n    auth) subcommands=\"login logout status whoami\" ;;\n    kv) subcommands=\"get put delete list head\" ;;\n    space) subcommands=\"list create info switch\" ;;\n    delegation) subcommands=\"create list info revoke\" ;;\n    share) subcommands=\"create receive list revoke\" ;;\n    node) subcommands=\"health version status\" ;;\n    profile) subcommands=\"list create show switch delete\" ;;\n    completion) subcommands=\"bash zsh fish\" ;;\n    *) COMPREPLY=( $(compgen -W \"\\${commands}\" -- \"\\${cur}\") ); return ;;\n  esac\n\n  if [ \\${COMP_CWORD} -eq 2 ]; then\n    COMPREPLY=( $(compgen -W \"\\${subcommands}\" -- \"\\${cur}\") )\n  fi\n}\ncomplete -F _tc_completions tc\n`;\n}\n\nfunction generateZshCompletion(): string {\n  return `#compdef tc\n\n_tc() {\n  local -a commands\n  commands=(\n    'init:Initialize a new TinyCloud profile'\n    'auth:Authentication management'\n    'kv:Key-value store operations'\n    'space:Space management'\n    'delegation:Manage delegations'\n    'share:Share data with others'\n    'node:Node health and info'\n    'profile:Profile management'\n    'completion:Generate shell completions'\n  )\n\n  _arguments -C \\\\\n    '(-p --profile)'{-p,--profile}'[Profile to use]:profile:' \\\\\n    '(-H --host)'{-H,--host}'[TinyCloud node URL]:url:' \\\\\n    '(-v --verbose)'{-v,--verbose}'[Enable verbose output]' \\\\\n    '--no-cache[Disable caching]' \\\\\n    '(-q --quiet)'{-q,--quiet}'[Suppress non-essential output]' \\\\\n    '1:command:->cmd' \\\\\n    '*::arg:->args'\n\n  case $state in\n    cmd)\n      _describe 'command' commands\n      ;;\n    args)\n      case $words[1] in\n        auth) _values 'subcommand' login logout status whoami ;;\n        kv) _values 'subcommand' get put delete list head ;;\n        space) _values 'subcommand' list create info switch ;;\n        delegation) _values 'subcommand' create list info revoke ;;\n        share) _values 'subcommand' create receive list revoke ;;\n        node) _values 'subcommand' health version status ;;\n        profile) _values 'subcommand' list create show switch delete ;;\n        completion) _values 'subcommand' bash zsh fish ;;\n      esac\n      ;;\n  esac\n}\n\n_tc\n`;\n}\n\nfunction generateFishCompletion(): string {\n  return `# tc fish completion\nset -l commands init auth kv space delegation share node profile completion\n\n# Disable file completion by default\ncomplete -c tc -f\n\n# Top-level commands\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a init -d \"Initialize a new TinyCloud profile\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a auth -d \"Authentication management\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a kv -d \"Key-value store operations\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a space -d \"Space management\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a delegation -d \"Manage delegations\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a share -d \"Share data with others\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a node -d \"Node health and info\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a profile -d \"Profile management\"\ncomplete -c tc -n \"not __fish_seen_subcommand_from $commands\" -a completion -d \"Generate shell completions\"\n\n# Subcommands\ncomplete -c tc -n \"__fish_seen_subcommand_from auth\" -a \"login logout status whoami\"\ncomplete -c tc -n \"__fish_seen_subcommand_from kv\" -a \"get put delete list head\"\ncomplete -c tc -n \"__fish_seen_subcommand_from space\" -a \"list create info switch\"\ncomplete -c tc -n \"__fish_seen_subcommand_from delegation\" -a \"create list info revoke\"\ncomplete -c tc -n \"__fish_seen_subcommand_from share\" -a \"create receive list revoke\"\ncomplete -c tc -n \"__fish_seen_subcommand_from node\" -a \"health version status\"\ncomplete -c tc -n \"__fish_seen_subcommand_from profile\" -a \"list create show switch delete\"\ncomplete -c tc -n \"__fish_seen_subcommand_from completion\" -a \"bash zsh fish\"\n\n# Global options\ncomplete -c tc -l profile -s p -d \"Profile to use\"\ncomplete -c tc -l host -s H -d \"TinyCloud node URL\"\ncomplete -c tc -l verbose -s v -d \"Enable verbose output\"\ncomplete -c tc -l no-cache -d \"Disable caching\"\ncomplete -c tc -l quiet -s q -d \"Suppress non-essential output\"\n`;\n}\n"],"mappings":"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","names":["join","rm","join","rm","program","program","readFile","writeFile","program","writeFile","readFile","program","program","program","program","createInterface","program","createInterface","program"]}